---
phase: 05-output-features-production-readiness
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/upload-zone.tsx
  - components/before-after-slider.tsx
  - app/globals.css
autonomous: true

must_haves:
  truths:
    - "User can download with MsFrozen-[original].jpg filename"
    - "User can drag slider to compare before/after images"
    - "UI transitions smoothly between states with animations"
    - "User can click New to reset and upload a different image (clears slider)"
  artifacts:
    - path: "components/before-after-slider.tsx"
      provides: "Before/after image comparison"
      exports: ["BeforeAfterSlider"]
    - path: "components/upload-zone.tsx"
      provides: "Updated download and slider integration"
      contains: "MsFrozen-"
    - path: "app/globals.css"
      provides: "Transition animations"
      contains: "@keyframes fade-in"
  key_links:
    - from: "components/upload-zone.tsx"
      to: "components/before-after-slider.tsx"
      via: "import and render when transformed"
      pattern: "BeforeAfterSlider"
    - from: "components/upload-zone.tsx"
      to: "downloadTransformedImage"
      via: "click handler for download"
      pattern: "MsFrozen-"
    - from: "handleReset"
      to: "transformedUrl state"
      via: "setTransformedUrl(null)"
      pattern: "setTransformedUrl\\(null\\)"
---

<objective>
Output polish and UI transitions

Purpose: Complete the user experience with proper download branding (MsFrozen filename), before/after comparison slider for transformation results, and smooth animated transitions throughout the UI.

Output: BeforeAfterSlider component, updated download with MsFrozen branding, CSS animations for transitions
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-output-features-production-readiness/05-RESEARCH.md

# Key existing files
@components/upload-zone.tsx
@app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install react-compare-slider and create BeforeAfterSlider component</name>
  <files>components/before-after-slider.tsx, package.json</files>
  <action>
    1. Install react-compare-slider:
       ```bash
       npm install react-compare-slider
       ```
       If peer dependency conflict with React 19, use `--legacy-peer-deps`

    2. Create `components/before-after-slider.tsx`:
       - Import ReactCompareSlider, ReactCompareSliderImage from react-compare-slider
       - Props: beforeSrc (string), afterSrc (string)
       - Render ReactCompareSlider with custom handle styling matching the gold accent color (#d4af37)
       - Use project's styling conventions (rounded-lg, shadow-lg)
       - Add motion-reduce support for accessibility

    Pattern from research:
    ```typescript
    import { ReactCompareSlider, ReactCompareSliderImage, ReactCompareSliderHandle } from 'react-compare-slider';

    export function BeforeAfterSlider({ beforeSrc, afterSrc }: Props) {
      return (
        <ReactCompareSlider
          itemOne={<ReactCompareSliderImage src={beforeSrc} alt="Original" />}
          itemTwo={<ReactCompareSliderImage src={afterSrc} alt="Transformed" />}
          handle={
            <ReactCompareSliderHandle
              buttonStyle={{
                backdropFilter: 'blur(4px)',
                backgroundColor: 'rgba(255, 255, 255, 0.8)',
                border: '2px solid #d4af37',
              }}
              linesStyle={{ color: '#d4af37' }}
            />
          }
          position={50}
        />
      );
    }
    ```
  </action>
  <verify>
    - `npm run build` succeeds
    - `grep -r "react-compare-slider" package.json` shows the dependency
    - `ls components/before-after-slider.tsx` confirms file exists
  </verify>
  <done>BeforeAfterSlider component created with gold accent styling, react-compare-slider installed</done>
</task>

<task type="auto">
  <name>Task 2: Add transition animations, update download branding, and verify reset functionality</name>
  <files>app/globals.css, components/upload-zone.tsx</files>
  <action>
    1. Add transition animations to `app/globals.css` inside the @theme block:
       - Add fade-in keyframes (0.3s ease-out)
       - Add slide-up keyframes (0.3s ease-out)
       - Add scale-in keyframes (0.2s ease-out)
       - Add corresponding --animate-* CSS variables
       - Add motion-reduce support: `@media (prefers-reduced-motion: reduce)` to disable animations

    2. Update `components/upload-zone.tsx`:
       - Change download filename from `transformed-${fileName}` to `MsFrozen-${baseName}.jpg`
         (where baseName = filename without extension)
       - Import and use BeforeAfterSlider when transformedUrl exists
       - Show slider instead of single transformed image
       - Apply animate-fade-in to key elements (preview container, buttons)

    Download pattern:
    ```typescript
    const baseName = fileName?.replace(/\.[^/.]+$/, '') || 'image';
    const downloadName = `MsFrozen-${baseName}.jpg`;
    ```

    Slider integration:
    - When transformedUrl exists, show BeforeAfterSlider with previewUrl as before and transformedUrl as after
    - Keep download button functional with transformedUrl

    3. Verify reset functionality:
       - Confirm handleReset clears BOTH previewUrl AND transformedUrl states
       - After clicking "New" button, slider must be hidden and upload state must be shown
       - The existing handleReset function already clears transformedUrl (line 72) - verify this works with new BeforeAfterSlider integration
  </action>
  <verify>
    - Download a transformed image and verify filename starts with "MsFrozen-"
    - After transformation, slider appears allowing comparison
    - Elements animate smoothly on appearance
    - Click "New" button: verify slider disappears and upload UI returns
    - `npm run build` succeeds
  </verify>
  <done>Download uses MsFrozen branding, BeforeAfterSlider shows after transformation, smooth animations applied, reset clears all state including slider</done>
</task>

</tasks>

<verification>
1. Upload an image
2. Click Create, wait for transformation
3. Verify: Slider appears showing before/after comparison
4. Verify: Dragging slider handle reveals original/transformed images
5. Click Download
6. Verify: Downloaded file is named `MsFrozen-[original-name].jpg`
7. Verify: Transitions animate smoothly (fade-in on load, etc.)
8. Click New button
9. Verify: Slider disappears, previewUrl and transformedUrl are cleared
10. Verify: Upload button/UI is shown again (user can start over)
11. Upload a new image and repeat flow to confirm reset works properly
</verification>

<success_criteria>
- react-compare-slider installed and working
- BeforeAfterSlider component renders comparison correctly
- Download saves as MsFrozen-[original].jpg
- Animations smooth with no jank
- All transitions respect motion-reduce preference
- Reset ("New") button clears both previewUrl and transformedUrl, hiding slider
- User can upload a new image after reset to start over
- npm run build passes
</success_criteria>

<output>
After completion, create `.planning/phases/05-output-features-production-readiness/05-01-SUMMARY.md`
</output>
