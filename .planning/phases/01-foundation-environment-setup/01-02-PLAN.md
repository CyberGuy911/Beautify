---
phase: 01-foundation-environment-setup
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - components/theme-toggle.tsx
  - components/ui/button.tsx
  - app/page.tsx
  - app/globals.css
autonomous: true

must_haves:
  truths:
    - "User can click theme toggle to switch between dark and light mode"
    - "Theme preference persists across page refresh"
    - "Toggle shows sun icon in dark mode, moon icon in light mode"
    - "Theme transitions are smooth (not jarring)"
    - "Page has minimal footer with credits"
  artifacts:
    - path: "components/theme-toggle.tsx"
      provides: "Theme toggle button component"
      contains: "useTheme"
    - path: "app/page.tsx"
      provides: "Home page layout with toggle and footer"
      contains: "ThemeToggle"
  key_links:
    - from: "components/theme-toggle.tsx"
      to: "next-themes"
      via: "useTheme hook"
      pattern: "useTheme.*setTheme"
    - from: "app/page.tsx"
      to: "components/theme-toggle.tsx"
      via: "component import"
      pattern: "import.*ThemeToggle"
---

<objective>
Create the UI shell with theme toggle component and minimal page layout.

Purpose: Implement the user-facing theme switching feature (UEXP-02) and establish the base page structure for subsequent phases.

Output: A working theme toggle with sun/moon icons, smooth transitions, localStorage persistence, and a minimal page layout with footer.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-environment-setup/01-CONTEXT.md
@.planning/phases/01-foundation-environment-setup/01-RESEARCH.md
@.planning/phases/01-foundation-environment-setup/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create theme toggle component with sun/moon icons</name>
  <files>
    - components/theme-toggle.tsx
  </files>
  <action>
    1. Install lucide-react for icons (if not already installed by shadcn):
       ```bash
       npm install lucide-react
       ```

    2. Create `components/theme-toggle.tsx`:
       ```typescript
       "use client"

       import { Moon, Sun } from "lucide-react"
       import { useTheme } from "next-themes"
       import { useEffect, useState } from "react"
       import { Button } from "@/components/ui/button"

       export function ThemeToggle() {
         const { theme, setTheme } = useTheme()
         const [mounted, setMounted] = useState(false)

         // Avoid hydration mismatch - only render after mount
         useEffect(() => {
           setMounted(true)
         }, [])

         if (!mounted) {
           // Return placeholder with same dimensions to prevent layout shift
           return (
             <Button variant="ghost" size="icon" disabled className="opacity-0">
               <Sun className="h-5 w-5" />
             </Button>
           )
         }

         return (
           <Button
             variant="ghost"
             size="icon"
             onClick={() => setTheme(theme === "dark" ? "light" : "dark")}
             className="relative"
             aria-label={`Switch to ${theme === "dark" ? "light" : "dark"} mode`}
           >
             <Sun className="h-5 w-5 rotate-0 scale-100 transition-all duration-300 dark:-rotate-90 dark:scale-0" />
             <Moon className="absolute h-5 w-5 rotate-90 scale-0 transition-all duration-300 dark:rotate-0 dark:scale-100" />
             <span className="sr-only">Toggle theme</span>
           </Button>
         )
       }
       ```

       Key implementation details:
       - `mounted` state prevents hydration mismatch (server doesn't know theme)
       - Placeholder has same dimensions to prevent layout shift
       - Icons rotate and scale with smooth 300ms transitions
       - `aria-label` updates based on current theme for accessibility
       - Using `variant="ghost"` for subtle appearance
  </action>
  <verify>
    - Component file exists at `components/theme-toggle.tsx`
    - No TypeScript errors in the file
    - `lucide-react` is in package.json dependencies
  </verify>
  <done>
    Theme toggle component created with sun/moon icons, smooth rotation animation, and hydration-safe mounting.
  </done>
</task>

<task type="auto">
  <name>Task 2: Build page layout with header, main area, and footer</name>
  <files>
    - app/page.tsx
    - app/globals.css
  </files>
  <action>
    1. Update `app/page.tsx` with minimal layout structure:
       ```typescript
       import { ThemeToggle } from "@/components/theme-toggle"

       export default function Home() {
         return (
           <div className="min-h-screen flex flex-col">
             {/* Header */}
             <header className="flex items-center justify-between px-6 py-4 border-b border-border">
               <h1 className="text-xl font-semibold text-accent">Beautify</h1>
               <ThemeToggle />
             </header>

             {/* Main content area */}
             <main className="flex-1 flex items-center justify-center p-6">
               <div className="text-center space-y-4">
                 <h2 className="text-3xl md:text-4xl font-bold">
                   Transform Your Photos
                 </h2>
                 <p className="text-muted max-w-md mx-auto">
                   Upload an image and watch it transform into a mystical cosmic portrait.
                 </p>
                 {/* Upload area will be added in Phase 2 */}
                 <div className="w-full max-w-md h-64 border-2 border-dashed border-border rounded-lg flex items-center justify-center mt-8">
                   <p className="text-muted">Upload area coming soon</p>
                 </div>
               </div>
             </main>

             {/* Footer */}
             <footer className="py-4 text-center text-sm text-muted border-t border-border">
               <p>
                 Built with{" "}
                 <span className="text-accent">Gemini</span> AI
               </p>
             </footer>
           </div>
         )
       }
       ```

    2. Add any additional utility classes to `app/globals.css` if needed for the layout:
       - The existing theme variables should handle colors
       - Ensure `text-accent` uses the gold color
       - Ensure `text-muted` and `border-border` work correctly

       If the utility classes don't work, add these explicit mappings after the existing CSS:
       ```css
       /* Utility class mappings */
       .text-accent {
         color: var(--color-accent);
       }

       .text-muted {
         color: var(--color-muted);
       }

       .border-border {
         border-color: var(--color-border);
       }

       .bg-background {
         background-color: var(--color-background);
       }

       .text-foreground {
         color: var(--color-foreground);
       }
       ```
  </action>
  <verify>
    - Page loads at http://localhost:3000 with:
      - Header with "Beautify" title (gold) and theme toggle (top right)
      - Centered main content with heading and placeholder
      - Footer with "Built with Gemini AI" text
    - Theme toggle switches between dark and light mode
    - Layout is responsive (works on mobile widths)
  </verify>
  <done>
    Page layout complete with header (title + toggle), centered main area, and minimal footer. Theme toggle is functional with smooth transitions.
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify localStorage persistence and transitions</name>
  <files>None (verification task)</files>
  <action>
    This is a verification task to confirm the theme system works correctly:

    1. Test localStorage persistence:
       - Open http://localhost:3000
       - Note the current theme (should be dark by default)
       - Click theme toggle to switch to light mode
       - Hard refresh the page (Ctrl+Shift+R or Cmd+Shift+R)
       - Page should load in light mode (persisted)
       - Open DevTools > Application > Local Storage
       - Verify there's a "theme" key with value "light"

    2. Test smooth transitions:
       - Click theme toggle multiple times
       - Background and text colors should fade smoothly (300ms)
       - Icons should rotate smoothly during switch
       - No jarring/instant color changes

    3. Test system preference (optional):
       - Clear localStorage theme key
       - Set system to light mode (OS settings)
       - Refresh - should follow system preference
       - Toggle manually - should override system

    4. Test no flash-on-load:
       - Set theme to light mode
       - Refresh page
       - Should NOT flash dark then switch to light
       - Page should render directly in correct theme

    If any issues found, fix by:
    - Checking ThemeProvider config in layout.tsx
    - Ensuring `suppressHydrationWarning` is on html element
    - Verifying CSS transitions are applied to body
  </action>
  <verify>
    - localStorage contains theme preference after switching
    - Page loads with correct theme after refresh (no flash)
    - Transitions are smooth when toggling
    - System preference is respected when no explicit choice made
  </verify>
  <done>
    Theme persistence verified: localStorage saves preference, page loads without flash, transitions are smooth.
  </done>
</task>

</tasks>

<verification>
Run these checks after completing all tasks:

1. **Theme toggle works:**
   - Click toggle - theme switches between dark and light
   - Icons animate smoothly (sun rotates out, moon rotates in)

2. **Persistence works:**
   ```bash
   # In browser console:
   localStorage.getItem('theme')
   # Should return 'light' or 'dark' based on last selection
   ```

3. **No flash on load:**
   - Set to light mode
   - Hard refresh
   - Page loads directly in light mode (no dark flash)

4. **Layout is correct:**
   - Header spans full width with title left, toggle right
   - Main content is centered vertically and horizontally
   - Footer is at bottom
   - Gold accent color visible in title and footer

5. **Responsive design:**
   - Resize browser to mobile width
   - Layout should adapt gracefully
   - No horizontal scroll
</verification>

<success_criteria>
- [ ] Theme toggle component with sun/moon icons
- [ ] Smooth rotation animation on toggle (300ms)
- [ ] Theme persists in localStorage across refresh
- [ ] No flash-of-unstyled-content on page load
- [ ] Page layout with header, main area, and footer
- [ ] "Beautify" title in gold accent color
- [ ] Footer with "Built with Gemini AI"
- [ ] Responsive design works on mobile
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-environment-setup/01-02-SUMMARY.md`
</output>
