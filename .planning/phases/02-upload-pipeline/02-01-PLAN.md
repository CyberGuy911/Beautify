---
phase: 02-upload-pipeline
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/upload-zone.tsx
autonomous: true

must_haves:
  truths:
    - "User can drag image onto viewport and see visual feedback"
    - "User can click button to open file browser"
    - "App accepts JPEG, PNG, WebP files only"
    - "Invalid file types show clear error message"
  artifacts:
    - path: "components/upload-zone.tsx"
      provides: "Upload zone with drag-drop and file validation"
      exports: ["UploadZone"]
      min_lines: 80
  key_links:
    - from: "components/upload-zone.tsx"
      to: "native File API"
      via: "onDrop handler extracts files, validates type"
      pattern: "onDrop.*file\\.type"
---

<objective>
Create the upload zone component with full-page drag-and-drop, click-to-browse, and file type validation.

Purpose: Proves file intake works before adding preview/download complexity
Output: Reusable UploadZone component that validates and accepts images
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase context
@.planning/phases/02-upload-pipeline/02-CONTEXT.md

# Existing UI patterns
@components/ui/button.tsx
@app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create upload zone with drag-drop and validation</name>
  <files>components/upload-zone.tsx</files>
  <action>
Create client component with:

1. **Full-viewport drop detection:**
   - Use document-level dragenter/dragleave/drop listeners (attach in useEffect)
   - Track isDragging state to show overlay
   - Prevent default on dragover to enable drop

2. **Visual feedback on drag-over:**
   - Overlay with border highlight or tint when dragging over viewport
   - Use gold accent color (--color-accent) for highlight
   - Animate transition (300ms matches existing theme transitions)

3. **Click-to-browse:**
   - Hidden file input with ref
   - Centered button triggers input.click()
   - Use existing Button component with default variant
   - Upload icon from lucide-react (Upload or ImagePlus)
   - Minimal text: just icon, or "Upload" single word max

4. **File type validation:**
   - Accept only: image/jpeg, image/png, image/webp
   - Check file.type on drop and file input change
   - Invalid type: set error state, do NOT call onFileAccepted

5. **Error display:**
   - Show validation error below upload button
   - Clear error when user tries again
   - Use muted-foreground for error text, or destructive red

6. **Props interface:**
   ```typescript
   interface UploadZoneProps {
     onFileAccepted: (file: File) => void
     disabled?: boolean
   }
   ```

7. **Styling requirements:**
   - Works in both light and dark mode
   - Responsive: centered content, reasonable padding
   - Matches cosmic theme (dark space feel when in dark mode)

Do NOT:
- Add preview logic (that's Plan 02)
- Handle file reading/base64 conversion (that's Phase 3)
- Add progress indicators yet (will add when wiring in Plan 02)
  </action>
  <verify>
Manual test in browser:
1. Run `npm run dev`
2. Drag image file over viewport - see visual overlay
3. Drop valid image (JPEG/PNG/WebP) - no error, onFileAccepted logs file
4. Drop invalid file (PDF, GIF) - see error message
5. Click button - file browser opens
6. Select valid file - no error
7. Select invalid file - see error message
8. Test in both light and dark mode

TypeScript compiles: `npx tsc --noEmit`
  </verify>
  <done>
UploadZone component accepts drag-drop and click-to-browse, validates file types, shows errors for invalid files, calls onFileAccepted for valid files
  </done>
</task>

</tasks>

<verification>
- [ ] Drag image over viewport shows visual feedback
- [ ] Drop zone accepts JPEG, PNG, WebP
- [ ] Drop zone rejects other formats with error message
- [ ] Click button opens file browser
- [ ] Component works in light and dark mode
- [ ] TypeScript compiles without errors
</verification>

<success_criteria>
Upload zone component exists and handles all file intake scenarios (drag-drop, click-browse, validation) without preview functionality.
</success_criteria>

<output>
After completion, create `.planning/phases/02-upload-pipeline/02-01-SUMMARY.md`
</output>
